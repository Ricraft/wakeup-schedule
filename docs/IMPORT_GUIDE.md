# 课表导入指南

本文档介绍如何将课表数据导入到 WakeUp 课程表系统中。

## 支持的导入格式

### 1. HTML 格式

#### 1.1 强智教务系统格式（推荐）

如果你的学校使用强智教务系统，可以直接导出 HTML 课表文件：

**导出步骤**：
1. 登录教务系统
2. 进入"个人课表"或"学生课表"页面
3. 右键点击页面 → "另存为" → 保存为 HTML 文件
4. 在 WakeUp 中选择"文件" → "导入" → "从 HTML 导入"

**特征识别**：
- 包含 `<table id="kbtable">` 标签
- 包含 `<div class="kbcontent">` 标签
- 包含 `<font title="...">` 标签

系统会自动识别强智格式并使用专用解析器。

#### 1.2 通用 HTML 表格格式

如果你的教务系统不是强智系统，但可以导出 HTML 表格：

**要求**：
- 必须包含 `<table>` 标签
- 表格中应包含星期信息（如"星期一"、"周一"等）
- 表格中应包含节次信息（如"第1节"、"第2节"等）

**单元格格式**：
```
课程名 {第1-16周 教师名 教室
```

**示例**：
```html
<table id="Table1">
    <tr>
        <td>时间</td>
        <td>星期一</td>
        <td>星期二</td>
    </tr>
    <tr>
        <td>第1节</td>
        <td>高等数学 {第1-16周 张老师 A101</td>
        <td>线性代数 {第1-16周(单) 李老师 B202</td>
    </tr>
</table>
```

### 2. Excel 格式

#### 2.1 使用标准模板（推荐）

**下载模板**：
1. 在 WakeUp 中选择"文件" → "导入" → "下载 Excel 模板"
2. 或者从 `examples/` 目录获取 `schedule_template.xlsx`

**填写说明**：
- 第一行：表头（节次、周一、周二、...、周日）
- 第一列：节次（1、2、3、...）
- 其他单元格：课程信息

**单元格格式**：

**格式 1：完整格式（推荐）**
```
课程名 {第1-16周 教师名 教室
```

**格式 2：简化格式**
```
课程名 教师名 教室
```
注：简化格式默认周次为 1-16 周

**单双周标记**：
- 单周：`{第1-16周(单)`
- 双周：`{第1-16周(双)`
- 每周：`{第1-16周`

**示例**：

| 节次 | 周一 | 周二 | 周三 |
|------|------|------|------|
| 1 | 高等数学 {第1-16周 张老师 A101 | 线性代数 {第1-16周(单) 李老师 B202 | |
| 2 | | | 大学物理 {第1-16周 王老师 C303 |
| 3 | 英语 {第1-16周 赵老师 D404 | | |

#### 2.2 强智系统导出的 Excel

如果你的学校使用强智系统，并且可以导出 Excel 格式：

**特征**：
- 单元格中包含 `{第X-Y周` 格式的周次信息
- 系统会自动识别并使用专用解析器

**导入步骤**：
1. 从教务系统导出 Excel 文件
2. 在 WakeUp 中选择"文件" → "导入" → "从 Excel 导入"
3. 选择导出的文件

#### 2.3 自定义 Excel 格式

如果你有自己的 Excel 课表格式：

**基本要求**：
- 必须包含表头行（包含"周一"、"周二"等星期信息）
- 第一列通常为节次列
- 系统会自动检测表头位置

**支持的星期格式**：
- 中文：周一、星期一
- 英文：Monday、Mon

**注意事项**：
- 避免使用合并单元格（可能导致解析错误）
- 每个单元格只填写一门课程
- 如果一门课程有多个时间段，请分别填写在对应的单元格中

### 3. 文本格式

支持简单的文本格式导入（适合快速录入）：

**格式**：
```
课程名|教师|教室|星期|节次|周次
```

**示例**：
```
高等数学|张老师|A101|1|1-2|1-16
线性代数|李老师|B202|2|3-4|1-16(单)
```

## 常见问题

### Q1: 导入后课程显示不正确怎么办？

**A**: 检查以下几点：
1. 确认文件格式是否符合要求
2. 检查单元格中的周次格式是否正确（`{第1-16周`）
3. 确认星期和节次信息是否完整
4. 尝试使用标准模板重新填写

### Q2: 为什么有些课程没有导入？

**A**: 可能的原因：
1. 单元格格式不正确
2. 缺少必要的信息（课程名、周次等）
3. 单元格内容被识别为标题或无效内容

### Q3: 如何导入单双周课程？

**A**: 在周次信息后添加标记：
- 单周：`{第1-16周(单)`
- 双周：`{第1-16周(双)`

### Q4: 可以导入多个课表文件吗？

**A**: 可以。系统会将新导入的课程添加到现有课表中。如果有冲突，系统会提示你处理。

### Q5: 导入的课程颜色可以修改吗？

**A**: 可以。导入后，你可以在课程详情中修改课程颜色。

## 高级功能

### 批量导入

如果你需要为多个班级或多个学期导入课表：

1. 准备多个符合格式的文件
2. 依次导入每个文件
3. 系统会自动合并课程信息

### 导入后编辑

导入后，你可以：
- 修改课程信息（名称、教师、教室等）
- 调整课程时间
- 删除不需要的课程
- 添加新的课程

### 导出课表

导入并编辑完成后，你可以：
- 导出为 JSON 格式（用于备份）
- 导出为图片（用于分享）
- 打印课表

## 技术支持

如果遇到导入问题，请：

1. 查看日志文件（`logs/` 目录）
2. 检查文件格式是否符合要求
3. 尝试使用标准模板
4. 提交 Issue 到 GitHub 仓库

## 更新日志

### v3.0
- 新增智能格式检测
- 支持强智教务系统自动识别
- 优化 Excel 解析逻辑
- 新增标准模板下载

### v2.0
- 支持 HTML 导入
- 支持 Excel 导入
- 支持文本格式导入
